<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
        <title>Data in Two-dimensional Storage Structure</title>
    </head>
    <body style="width: 900px; margin:0 auto;" contenteditable="false">
        <h1 align="center">Data in Two-dimensional Storage Structure</h1>
        <h2>1 Data Objects</h2>
        <h3>1.1 External Formats</h3>
        <p>Following objects can be edited in consistent way:</p>
        <ul>
            <li>Data files, including CSV File, Excel file, texts file.</li>
            <li>Data of MyBox Clipboard</li>
            <li>Matrices</li>
            <li>Database tables.</li>
        </ul>
        <h3>1.2 Storage Structure</h3>
        <p>Data are represented as two-dimensional storage structure:</p>
        <ul>
            <li>"Columns" define attributes/fields of data and extend data dimensions in horizontal direction.</li>
            <li>"Rows" store instances of data and extend data set in vertical direction.</li>
            <li>Data should be in same width. That is all rows have equal number of columns.</li>
        </ul>

        <h2>2 Create Data</h2>
        <p>Data can be created by one of following ways:</p>
        <ul>
            <li>Click or hover button "Create Data", and select data type: CSV, Excel, Texts, MyBox Clipboard, Matrix, Database Table.</li>
            <li>Click button "Load contents in System Clipboard", and select rows and columns.</li>
            <li>Click or hover button "Examples", and select example data. Option "Only import definition".</li>
        </ul>
        <p>New data are temporary data and need necessary parameters, like file name or table name, inputted when saved.</p>

        <h2>3 Open Data</h2>
        <p>Existed data can be opened by one of following ways:</p>
        <ul>
            <li>Click or hover button "Select File" to load data in extrenal data file.</li>
            <li>Click button "Select"(CTRL+T or ALT+T) to load data managed by MyBox.</li>
        </ul>

        <h2>4 Four Modes</h2>
        <h3>4.1 Page data in html - read only</h3>
        <ul>
            <li>Display data of current page in html.</li>
            <li>Can not edit data.</li>
            <li>Can modify or delete data in batch with menu function.</li>
            <li>Can modify data definition.</li>
        </ul>
        <h3>4.2 Table - edit</h3>
        <ul>
            <li>Display data of current page in table.</li>
            <li>Can edit data.</li>
            <li>Can modify or delete data in batch with menu function.</li>
            <li>Can modify data definition.</li>
        </ul>
        <p>Except for texts file, multiple lines can be edited and saved to string values:</p>
        <ul>
            <li>When the value is single line(not include line break), 
                text field is shown when click the data cell; 
                write "\n" as line break in the value  and commit the change(return or click other place).</li>
            <li>When the value includes line breaks: 
                Text field is shown when click the data cell; 
                Write the text in multiple lines directly.</li>
        </ul>
        <h3>4.3 CSV - edit</h3>
        <ul>
            <li>Display data of current page in CSV format.</li>
            <li>Can modify data.</li>
            <li>Can modify or delete data in batch with menu function.</li>
            <li>Can modify data definition.</li>
            <li>Click button "Delimiter" to reload data and apply different delimiter. This delimiter does not affect source file.</li>
            <li>If a value contains delimiter or line break, the value should be surrounded by quotes.</li>
        </ul>
        <h3>4.4 Page data in texts - read only</h3>
        <ul>
            <li>Display data of current page in texts format.</li>
            <li>Can not edit data.</li>
            <li>Can modify or delete data in batch with menu function.</li>
            <li>Can modify data definition.</li>
            <li>Click button "Delimiter" to reload data and apply different delimiter. This delimiter does not affect source file.</li>
        </ul>

        <h2>5 Define Data</h2>
        <p>Click button or menu "Define Data".</p>

        <h3>5.1 Interface of Columns Management</h3>
        <p>Under tab "Columns", add/delete/change columns in table view:</p>
        <ol>
            <li><p>Column names should not be null nor duplicated.</p></li>
            <li><p>Click table cell to edit value directly.</p></li>
            <li><p>Double click column, or select column and click button "Edit", to open eidt-column window:</p>
                <ul>
                    <li>Click button "OK" to save modification of current column.</li>
                    <li>Click button "Recover" to load original definition of the column.</li>
                    <li>Click button "Select" to copy column definition from tree "Data Column".</li>
                    <li>Click button "Save" to write current column definition in tree "Data Column".</li>
                </ul>
            </li>
            <li><p>Can rename all columns with sequence numbers.</p></li>
            <li><p>Can set random colors.</p></li>
            <li><p>Can adjust orders of columns.</p></li>
            <li><p>Click button "OK" to apply modifications of columns to "Table" of current data.</p></li>
            <li><p>Click button "Recover" to discard modifications of columns and pick data from "Table" of current data.</p></li>
            <li><p>Click button "Select" copy column definitions from tree "Data Column".</p></li>
            <li><p>Click button "Import" to load column definitions from XML file.</p></li>
            <li><p>Click button "Export" to write column definitions as file. Supported formats include: XML/JSON/CSV/Excel.</p></li>
        </ol>

        <h3>5.2 Types of Columns</h3>
        <ol>
            <li value="1"><p>Types of columns include: String, Double, Float, Long, Integer, Short, Boolean, Datetime, Date, Era, Longitude, Latitude, 
                    Enumeration, Editable Enumeration, Enumerated Short, Color.</p></li>
            <li><p>This attribute is used to display, edit, calculate, and save data.</p></li>
            <li><p>Longitutde and Latitude are defined together generally.</p></li>
        </ol>

        <h3>5.3 Format of Column</h3>
        <ol>
            <li><p>This attribute is mainly for display. When data are inputted/edited, formats are not applied automatically and original inputs are kept.</p></li>
            <li><p>In some interfaces, like "Copy" or "Export", options "Save date/time/era and numbers as columns' formats" can be checked.</p><p></p></li>
        </ol>
        <h4>5.3.1 Format for Numbers</h4>
        <p>To numbers, format can be: group in thousands, group in ten thousands, scientific notation, and no format.</p>
        <h4>5.3.2 Format for Datetime/Date</h4>
        <p>To Datetime/Date, following are supported in formats: MM/dd/yy, yy-MM-dd, milliseconds, time zone, T separator, patch century, etc..</p>
        <h4>5.3.3 Format for Era</h4>
        <p>To Era, following are supported in formats: MM/dd/yy, yy-MM-dd, milliseconds, time zone, T separator, patch century, prefix/suffix of "AD" and "BC" in Chinese and English,etc..</p>
        <h4>5.3.4 Define Enumeration</h4>
        <p>To Enumeration, list of values can be defined.</p>
        <h4>5.3.5 Enumerated Short</h4>
        <p>Displayed as String, while saved as Short.</p>

        <h3>5.5 Color of Column</h3>
        <p>Column color is mainly used for data charts.</p>
        <p>When chart is generated, elements in it are displayed in colors as their columns' definitions. Then user can set chart in random colors.</p>

        <h3>5.6 Attributes of Data</h3>
        <p>Under tab "Attributes", set: data name, decimal scale, maximum value of random, and description.</p>

        <h3>6 Verify Data Values</h3>
        <ol>
            <li value="1"><p>The verified objects can be either rows in current page or all rows.</p></li>
        </ol>
        <ol start="2">
            <li><p>Following are checked:</p>
                <ul>
                    <li><p>If a column is defined as "not null", then null values are invalid for this column.</p></li>
                    <li><p>If a value is not satisfied with the column type, then the value is invalid.</p></li>
                </ul>
            </li>
        </ol>
        <ol start="3">
            <li>
                <p>Handle invalid value when edit:</p>
                <ul>
                    <li>
                        <p>Reject invalid value, and recover original value.</p>
                    </li>
                    <li>
                        <p>To data file, there is option to not reject invalid value and it is accepted while shown in abnormal color.</p>
                    </li>
                    <li>
                        <p>To matrix or database table, invalid value is always rejected.</p>
                    </li>
                </ul>
            </li>
        </ol>
        <ol start="4">
            <li>
                <p>Handle invalid value when save:</p>
                <ul>
                    <li>
                        <p>Reject invalid value, and fail to save.</p>
                    </li>
                    <li>
                        <p>To data file, there is option to not reject invalid value and it is written in file.</p>
                    </li>
                    <li>
                        <p>To matrix or database table, invalid value is always rejected.</p>
                    </li>
                </ul>
            </li>
        </ol>
        <ol start="5">
            <li>
                <p>Handle invalid value in other operations:</p>
                <ul>
                    <li>
                        <p>Options to choice: Fail, Use, Skip, Count as null, Count as zero.</p>
                    </li>
                    <li>
                        <p>If select "Fail", operation fails when invalid value is found.</p>
                    </li>
                    <li>
                        <p>If select "Use", invalid value is taken and applied in operation.</p>
                    </li>
                    <li>
                        <p>If select "Skip", involved column or row is ignored and does not take part in operation.</p>
                    </li>
                    <li>
                        <p>If select "Count as null", invalid value is replaced with null and take part in operation.</p>
                    </li>
                    <li>
                        <p>If select "Count as zero", invalid value is replaced with zero and take part in operation.</p>
                    </li>
                    <li>
                        <p>In some context, "Count as null" equals to "Skip".</p>
                    </li>
                </ul>
            </li>
        </ol>

        <h2>7 Edit Data</h2>
        <p>Principle of column usages is "Most tolerability and least manufacture".</p>

        <h3>7.1 Load Data</h3>
        <p>When load data, types of columns are not checked, and original values are read and imported.</p>

        <h3>7.2 Display Data</h3>
        <ol>
            <li><p>Parse values as columns' types.</p></li>
            <li><p>Rewrite values as columns' formats.</p></li>
            <li><p>Displayed invalid values in abnormal color.</p></li>
        </ol>

        <h3>7.3 Controls for editing</h3>
        <ul>
            <li><p>To Boolean, checkbox is provided.</p></li>
            <li><p>To Enumeration, list view is provided with selections.</p></li>
            <li><p>To Color, palette is provided.</p></li>
            <li><p>To Longitude and Latitude, map can be popped to locate coordinate.</p></li>
        </ul>

        <h3>7.4 Edit Data Cell</h3>
        <ol>
            <li><p>Click editable cell to start editing.</p></li>
            <li><p>When editing is started, its original value is displayed, while both type and format of column are ignored.</p></li>
            <li><p>While user inputs and modifies the value, value in the edit control is checked by column type:</p>
                <ul>
                    <li><p>If value is invalid, then edit contorl is displayed in abnormal color.</p></li>
                    <li><p>If value is valid, then edit control is displayed in normal color.</p></li>
                    <li><p>The value is always kept as what user has inputted.</p></li>
                </ul>
            </li>
        </ol>
        <ol start="4">
            <li><p>Press key ENTER to commit modification, and press key ESC to cancel editing.</p></li>
            <li><p>Option: Auto-commit modification when cell loses focus(click other control).</p></li>
            <li><p>When modification is committed, value in the edit control is checked:</p>
                <ul>
                    <li><p>If value is not changed, then no checking of column type nor saving.</p></li>
                    <li><p>If value is changed, then check the changed value as column type:</p>
                        <ul>
                            <li><p>To invalid value, if select "Reject invalid value when edit", then restore and display original value; 
                                    if not select rejection, then commit modification and display it in abnormal color.</p></li>
                            <li><p>To valid value, submit and save as new value, and then dsiplay saved value as type and format of the column.</p></li>
                        </ul></li>
                </ul>
            </li>
        </ol>
        <ol start="7">
            <li><p>Example, column type is Double, select "Reject invalid value when edit", and decimal scale is 2. When read "abc":</p>
                <ul>
                    <li><p>The data cell is displayed as "abc" in abnormal color.</p></li>
                    <li><p>User modifies it as "abc123":</p>
                        <ul>
                            <li><p>While user inputs the change, the text field is always in abnormal color.</p></li>
                            <li><p>After user clicks Enter or other control, this data cell comes back as "abc" in abnormal color.</p></li>
                        </ul></li>
                    <li><p>User modifies it as "123.4567":</p>
                        <ul>
                            <li><p>While user inputs the change, the text field is always in normal color.</p></li>
                            <li><p>After user clicks Enter or other control, this data cell is saved as "123.4567" and displayed as "123.46".</p></li>
                        </ul></li>
                </ul>
            </li>
        </ol>
        <ol start="8">
            <li><p>Other data cells are not affected. That is, data cells are always in originial values if they are not changed.</p></li>
        </ol>

        <h2>8 Save Data</h2>

        <h3>8.1 Interface</h3>
        <ul>
            <li>Click button "Save"(CTRL+S or ALT+S) to write modification in data.</li>
            <li>Changes of rows in "Table", including modify/add/delete/sort, affect rows of current page in file.</li>
            <li>Changes in columns and attributes, including modify/add/delete/sort, affect all rows in file.</li>
            <li>Changes of attributes and columns are saved in database.</li>
            <li>Click button "Save As"(F5 or CTRL+B or ALT+B) to write data in other format:
                CSV, Excel, Texts, MyBox Clipboard, Matrix, Database Table, System Clipboard, JSON, XML, HTML, PDF.</li>
        </ul>

        <h3>8.2 Save Data File</h3>
        <p>Values are written into file of CSV/Texts/Excel as strings.</p>
        <p>Option "Reject invalid value when edit".</p>

        <h3>8.3 Save Database Table</h3>
        <p>Invalid values are always rejected for database table.</p>
        <p>Values are written into database table as nearest types:</p>
        <table width="322" border="1"  cellpadding="4" cellspacing="0">
            <colgroup>
                <col width="146">
                <col width="158">
            </colgroup>
            <tbody>
                <tr valign="TOP">
                    <td width="146"><p align="CENTER"><b>Column Type of MyBox</b></p></td>
                    <td width="158"><p align="CENTER"><b>Data Type of JDBC</b></p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>String</p></td>
                    <td width="158"><p>VARCHAR</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Double</p></td>
                    <td width="158"><p>DOUBLE</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Float</p></td>
                    <td width="158"><p>FLOAT</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Long</p></td>
                    <td width="158"><p>BIGINT</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Integer</p></td>
                    <td width="158"><p>INT</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Short</p></td>
                    <td width="158"><p>SMALLINT</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Boolean</p></td>
                    <td width="158"><p>BOOLEAN</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Datetime</p></td>
                    <td width="158"><p>TIMESTAMP</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Date</p></td>
                    <td width="158"><p>DATE</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Era</p></td>
                    <td width="158"><p>BIGINT</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Longitude</p></td>
                    <td width="158"><p>DOUBLE</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Latitude</p></td>
                    <td width="158"><p>DOUBLE</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Enumeration</p></td>
                    <td width="158"><p>VARCHAR</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="146"><p>Color</p></td>
                    <td width="158"><p>VARCHAR</p></td>
                </tr>
            </tbody>
        </table>
        <p>Notice: derby does not support negative date, so Ear is saved as long.</p>

        <h3>8.4 Save Matrix</h3>
        <p>Invalid values are always rejected for matrix.</p>
        <p>All values in Matrix are saved as Double.</p>


        <h2>9 Calculate Data</h2>
        <ol>
            <li><p>Data are handled as original values, without concern about types and formats of columns.</p></li>
            <li><p>Values are parsed as need. Example, if the calculation requires double values, then try to convert values as doubles.</p></li>
            <li><p>If value conversion fails, then invalid value is handled as definition of column.</p></li>
            <li><p>Calculation itself can define how to handle invalid values. Definition of calculation priors to definition of column.</p></li>
            <li><p>Both column and calcultion can define decimal scale. Definition of calculation priors to definition of column.</p></li>
            <li><p>Example, Column type is String, and descriptive statistic is running against it:</p>
                <ul>
                    <li><p>Try to convert each value as double.</p></li>
                    <li><p>If "count invalid value as zero", then invalid values are calculated into "Count", and participate in calculations of "Mean" and "Sum".</p></li>
                    <li><p>If "skip invalid value", then invalid values are not involved in any calculation.</p></li>
                    <li><p>If "count invalid value as empty", then invalid values cause results of all calculations as invalid(Double.NaN).</p></li>
                </ul>
            </li>
        </ol>

        <h2>10 Sort Data</h2>
        <ol>
            <li><p>For any calculations involved in sorting, data will be translated into a temporary database table, and be sorted by database system.</p></li>
            <li><p>Results of sorting are related to columns' types. Example, string "124" is smaller than string "18", while number "124" is bigger than number "18".</p></li>
        </ol>

        <h2>11 Manage Data</h2>
        <p>MyBox records definition of data objects in its internal table:</p>
        <table width="100%" border="1" cellpadding="4" cellspacing="0">
            <colgroup>
                <col width="46*">
                <col width="49*">
                <col width="53*">
                <col width="50*">
                <col width="58*">
            </colgroup>
            <tbody>
                <tr valign="TOP">
                    <td width="18%"><p><br></p></td>
                    <td width="19%"><p align="CENTER"><b>csv/excel/text files</b></p></td>
                    <td width="21%"><p align="CENTER"><b>MyBox Clipboard</b></p></td>
                    <td width="20%"><p align="CENTER"><b>Matrice</b></p></td>
                    <td width="22%"><p align="CENTER"><b>Database tables</b></p></td>
                </tr>
                <tr valign="TOP">
                    <td width="18%"><p><b>Time to create data definition</b></p></td>
                    <td width="19%"><p>When data file is opened for the first time</p></td>
                    <td width="21%"><p>When data are copied in MyBox Clipboard</p></td>
                    <td width="20%"><p>When new matrix is saved in Matrices Manager</p></td>
                    <td width="22%"><p>When new table is saved in Database Table Manager</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="18%"><p><b>Storage location of data</b></p></td>
                    <td width="19%"><p>Data file</p></td>
                    <td width="21%"><p>Files under MyBox internal path.</p></td>
                    <td width="20%"><p>Database table of MyBox</p></td>
                    <td width="22%"><p>Database tables of MyBox</p></td>
                </tr>
                <tr valign="TOP">
                    <td width="18%"><p><b>When delete data definition</b></p></td>
                    <td width="19%"><p>Data file is not affected</p></td>
                    <td width="21%"><p>Internal file is deleted</p></td>
                    <td width="20%"><p>Data of matrix are cleared</p></td>
                    <td width="22%"><p>Database table is dropped</p></td>
                </tr>
            </tbody>
        </table> <br>

        <h2>12 Data File</h2>
        <p>Data files are external data. MyBox records their definition and keeps their independence.</p>
        <p>After read/write by MyBox, data files should be able to read/write by other ways properly.</p>

        <h3>12.1  CSV File</h3>
        <p>In CSV file:</p>
        <ul>
            <li>In general, the first line(header) defines column names, and each of followed lines defines a row of data.</li>
            <li>Values are separated by "delimiter" which can be string.</li>
            <li>If a value contains delimiter or line break, it should be surrounded by quotes.</li>
            <li>If delimiter is not "#", then lines started with "#" will be skipped(as comments).</li>
        </ul>
        <p>When MyBox handles CSV file:</p>
        <ul>
            <li>When the file is opened for the first time, the tool guesses its delimiter and charset. </li>
            <li>If file is read abnormally, use menu "File - Format" to change options and click button "OK".</li>
            <li>Data can be saved as different charsets and delimiters.</li>
        </ul>

        <h3>12.2  Excel File</h3>
        <p>In Excel file:</p>
        <ul>
            <li>In general, the first line(header) defines column names, and each of followed lines defines a row of data.</li>
        </ul>
        <p>When MyBox handles Excel file:</p>
        <ul>
            <li>If file is read abnormally, use menu "File - Format" to change options and click button "OK".</li>
            <li>With menu "File - Sheet", select one sheet to handle, or add/rename/edlete sheets.</li>
            <li>Data can be saved with current sheet only or all worksheets.</li>
        </ul>
        <p>Notice: Tool can only handle base data in Excel file. 
            If file includes format, style, formula, or chart, suggest to save changes as new file to avoid data loss.</p>

        <h3>12.3  Texts File</h3>
        <p>In texts file:</p>
        <ul>
            <li>In general, the first line(header) defines column names, and each of followed lines defines a row of data.</li>
            <li>Values are separated by "delimiter" which can be string. Regular expression is supported when parse the file.</li>
            <li>Values should not contain delimiter nor line break.</li>
            <li>If a line starts with "#", it will be skipped.</li>
        </ul>
        <p>When MyBox handles texts file:</p>
        <ul>
            <li>When the file is opened for the first time, the tool guesses its delimiter and charset. </li>
            <li>If file is read abnormally, use menu "File - Format" to change options and click button "OK".</li>
            <li>Not support multiple lines in values.</li>
            <li>Data can be saved as different charsets and delimiters.</li>
        </ul>

        <h2>13 Temporary Data File</h2>
        <p>Temporary data files are generated when:</p>
        <ul>
            <li>Import example.</li>
            <li>Create data chart.</li>
            <li>Caculate data.</li>
        </ul>
        <p>Temporary data are saved in CSV format, under internal temporary files path of MyBox by default.</p>
        <p>If files are under MyBox temporary files path:</p>
        <ul>
            <li>When MyBox exits, this path will be cleared automatically. So please save temporary data under other path if need.</li>
            <li>They will not be backed up automatically when edit.</li>
            <li>They will not be recorded when read or write, and will not appear in the list of "Recently accessed files".</li>
        </ul>
        <p>Option: Save temporary data under "generated" path.<br> 
            When this option is checked, temporary data files are not treated as "temporary files"。</p>

        <hr>
        <p>More details can be referred in <a href="https://mara-mybox.sourceforge.io/guide/MyBox-DataTools-en.pdf">"User Guide - Data Tools"</a></p> <br>
    </body>
</html>